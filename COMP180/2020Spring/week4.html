

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Review of Week 4 &mdash; Leo Irakliotis&#39; courses  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Review of Week 5" href="week5.html" />
    <link rel="prev" title="Review of Week 3" href="week3.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Leo Irakliotis' courses
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Courses</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../COMP141/introduction.html">COMP 141 Introduction to Computing Tools and Techniques</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COMP163/introduction.html">COMP 163 Discrete Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COMP170/introduction.html">COMP 170 Introduction to Java Programming</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../introduction.html">COMP 180 Data Analysis for the Sciences</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../organization.html">Course organization and logistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../organization.html#course-outline">Course outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../organization.html#ground-rules">Ground rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../organization.html#deadlines">Deadlines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../organization.html#student-hours-aka-office-hours">Student hours (aka office hours)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../organization.html#academic-integrity">Academic integrity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../organization.html#professionalism">Professionalism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../organization.html#zoom">Zoom</a></li>
<li class="toctree-l2"><a class="reference internal" href="../organization.html#formal-notices">Formal notices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reading.html">Reading material</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../notes.html">Leo's notes</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="weeklyReviews.html">Weekly Reviews - Spring 2020</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="week2.html">Review of Week 1 and Week 2</a></li>
<li class="toctree-l4"><a class="reference internal" href="week3.html">Review of Week 3</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Review of Week 4</a></li>
<li class="toctree-l4"><a class="reference internal" href="week5.html">Review of Week 5</a></li>
<li class="toctree-l4"><a class="reference internal" href="week6.html">Review of Week 6</a></li>
<li class="toctree-l4"><a class="reference internal" href="week7.html">Review of Week 7: Intro to machine learning</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../COMP271/introduction.html">COMP 271 Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COMP363/introduction.html">COMP 363 Design and Analysis of Computer Algorithms</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Projects</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../DEI/DEI.html">DEI initiative</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DBD/introduction.html">Databases Design</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../LeoIrakliotis.html">Shameless self-promotion</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Leo Irakliotis' courses</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../introduction.html">COMP 180 Data Analysis for the Sciences</a> &raquo;</li>
        
          <li><a href="../notes.html">Leo’s notes</a> &raquo;</li>
        
          <li><a href="weeklyReviews.html">Weekly Reviews - Spring 2020</a> &raquo;</li>
        
      <li>Review of Week 4</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/COMP180/2020Spring/week4.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="review-of-week-4">
<h1>Review of Week 4<a class="headerlink" href="#review-of-week-4" title="Permalink to this headline">¶</a></h1>
<p>We are exploring a <a class="reference external" href="https://github.com/lgreco/cdp/blob/master/source/COMP180/code/measles.csv">data set with information about measles cases</a> for each state and each week, from 1928 to 2002. To manipulate the measles data, we are developing <a class="reference external" href="https://github.com/lgreco/cdp/blob/master/source/COMP180/code/eradication/US%20Measles%20analysis.ipynb">a notebook that allows us to transform and process the information in the data set</a>.</p>
<p>The notebook contains the following components.</p>
<div class="section" id="dependences">
<h2>Dependences<a class="headerlink" href="#dependences" title="Permalink to this headline">¶</a></h2>
<p>This cell loads the necessary tools for our work.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="lineno">1 </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="lineno">2 </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="lineno">3 </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="lineno">4 </span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
</div>
<div class="section" id="extraction">
<h2>Extraction<a class="headerlink" href="#extraction" title="Permalink to this headline">¶</a></h2>
<p>This cell reads the data from a <em>comma separated values</em> (CSV) file to a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> dataframe. We also print a few rows from the dataframe (using the <code class="docutils literal notranslate"><span class="pre">.head()</span></code>) method, to make sure that the information was brought it correctly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="lineno">1 </span><span class="n">measles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;measles.csv&quot;</span><span class="p">)</span>
<span class="lineno">2 </span><span class="n">measles</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="transform">
<h2>Transform<a class="headerlink" href="#transform" title="Permalink to this headline">¶</a></h2>
<p>As we look at the data, we notice that the set compounds the information about year and week into a six-digit field, of the form <code class="docutils literal notranslate"><span class="pre">YYYYWW</span></code>, where <code class="docutils literal notranslate"><span class="pre">YYYY</span></code> is the year value and <code class="docutils literal notranslate"><span class="pre">WW</span></code> is the week value, e.g., 192801 is a label for the first week of 1928. Our analysis can benefit from clear separate values for year and number-of-week in that year, and that’s what happens in the block below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="lineno">1 </span><span class="n">measles</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">measles</span><span class="p">[</span><span class="s2">&quot;week&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]))</span>
<span class="lineno">2 </span><span class="n">measles</span><span class="p">[</span><span class="s2">&quot;week_num&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">measles</span><span class="p">[</span><span class="s2">&quot;week&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">4</span><span class="p">:</span><span class="mi">7</span><span class="p">]))</span>
<span class="lineno">3 </span><span class="n">measles</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;week&quot;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>By inspecting the data set, we note that the first four characters of the field <code class="docutils literal notranslate"><span class="pre">week</span></code> represent the actual year while the remaining two, a week in that year. Thus we use the Python function <code class="docutils literal notranslate"><span class="pre">str</span></code> to cleave the first four characters (via the <code class="docutils literal notranslate"><span class="pre">[0:4]</span></code> reference, and return that value as an <code class="docutils literal notranslate"><span class="pre">int</span></code> number into a new column within the dataframe, that we label <code class="docutils literal notranslate"><span class="pre">year</span></code>).</p>
</div>
<div class="section" id="aggregation">
<h2>Aggregation<a class="headerlink" href="#aggregation" title="Permalink to this headline">¶</a></h2>
<p>Now that our data are clean and in the proper format, we need to think about aggradation. Aggregation means the ability to summarize data based on some common property. For example, pull together all the records for a given state, and add up all the measles cases: that will give us the total of measles in that state from 1928 to 2002. Or, pull together all the records for each state for each year, and add up the number of cases: this will give us the total number of cases per state, per year.</p>
<p>Using dataframes in the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library, we can use the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> method to achieve the desired aggregation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="lineno"> 1 </span><span class="k">def</span> <span class="nf">aggregate</span><span class="p">(</span><span class="n">thisDataframe</span><span class="p">,</span> <span class="n">byThisColumn</span><span class="p">):</span>
<span class="lineno"> 2 </span>
<span class="lineno"> 3 </span>    <span class="n">groupedByThisColumn</span> <span class="o">=</span> <span class="n">thisDataframe</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="n">byThisColumn</span><span class="p">)</span>
<span class="lineno"> 4 </span>    <span class="c1"># aggregate sum(cases), avg(cases), avg(incidence)</span>
<span class="lineno"> 5 </span>    <span class="n">sumOfCases</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">groupedByThisColumn</span><span class="p">[</span><span class="s2">&quot;cases&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="lineno"> 6 </span>    <span class="n">avgOfCases</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">groupedByThisColumn</span><span class="p">[</span><span class="s2">&quot;cases&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="lineno"> 7 </span>    <span class="n">avgIncidenceYear</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">groupedByThisColumn</span><span class="p">[</span><span class="s2">&quot;incidence_per_capita&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="lineno"> 8 </span>    <span class="c1"># rename columns</span>
<span class="lineno"> 9 </span>    <span class="n">avgIncidenceYear</span> <span class="o">=</span> <span class="n">avgIncidenceYear</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;incidence_per_capita&quot;</span><span class="p">:</span> <span class="s2">&quot;weekly average incidence&quot;</span><span class="p">})</span>
<span class="lineno">10 </span>    <span class="n">sumOfCases</span> <span class="o">=</span> <span class="n">sumOfCases</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cases&quot;</span><span class="p">:</span> <span class="s2">&quot;yearly sum&quot;</span><span class="p">})</span>
<span class="lineno">11 </span>    <span class="n">avgOfCases</span> <span class="o">=</span> <span class="n">avgOfCases</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cases&quot;</span><span class="p">:</span> <span class="s2">&quot;weekly average&quot;</span><span class="p">})</span>
<span class="lineno">12 </span>    <span class="c1"># put dataframes together</span>
<span class="lineno">13 </span>    <span class="n">measlesCases</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">avgOfCases</span><span class="p">,</span> <span class="n">sumOfCases</span><span class="p">)</span>
<span class="lineno">14 </span>    <span class="n">newDataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">avgIncidenceYear</span><span class="p">,</span> <span class="n">measlesCases</span><span class="p">)</span>
<span class="lineno">15 </span>    <span class="k">return</span> <span class="n">newDataframe</span>
</pre></div>
</div>
<p>The function above performs creates new dataframes and loads them with aggregate data of our choice.</p>
</div>
<div class="section" id="loading">
<h2>Loading<a class="headerlink" href="#loading" title="Permalink to this headline">¶</a></h2>
<p>With the aggregate function in place, we can begin the loading stage of our analysis. This stage creates new dataframes that answer specific queries. For example, the dataframe <code class="docutils literal notranslate"><span class="pre">measles_yearly_data</span></code> below answers the query: how many measles cases were there in each state, for each year in our dataset? The dataframe <code class="docutils literal notranslate"><span class="pre">measlesByYear</span></code> answers the query, how many measles cases per year.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="lineno">1 </span><span class="n">measles_yearly_data</span> <span class="o">=</span> <span class="n">aggregate</span><span class="p">(</span><span class="n">measles</span><span class="p">,</span> <span class="n">byThisColumn</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;state_name&quot;</span><span class="p">])</span>
<span class="lineno">2 </span><span class="n">measlesByYear</span> <span class="o">=</span> <span class="n">aggregate</span><span class="p">(</span><span class="n">measles</span><span class="p">,</span> <span class="n">byThisColumn</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="week5.html" class="btn btn-neutral float-right" title="Review of Week 5" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="week3.html" class="btn btn-neutral float-left" title="Review of Week 3" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2019-2021, Leo Irakliotis.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>